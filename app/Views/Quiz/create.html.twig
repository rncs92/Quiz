<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <title>Vendon | Izveidot</title>
</head>
<body class="bg-gray-200 w-screen h-screen">
<section class="relative mx-auto w-fit">
    <nav class="flex justify-between bg-cyan-800 text-white w-screen">
        <div class="px-5 xl:px-12 py-6 flex w-full items-center">
            <a class="text-3xl font-bold font-heading" href="/index">
                <img src="https://vendon.net/wp-content/uploads/2021/06/Logo_Header-1.svg" width="200" height="46"
                     class="attachment-full size-full wp-image-2389 astra-logo-svg" loading="lazy" alt="Vendon">
            </a>
            <ul class="hidden md:flex px-4 mx-auto font-semibold font-heading space-x-12">
                <li><a class="hover:text-yellow-400 hover:bg-cyan-900 px-6 py-4 rounded-lg" href="/index">Sākums</a>
                </li>
                <li><a class="hover:text-yellow-400 hover:bg-cyan-900 px-6 py-4 rounded-lg" href="/create">Izveidot
                        testu</a></li>
                <li><a class="hover:text-yellow-400 hover:bg-cyan-900 px-6 py-4 rounded-lg" href="#">Statistika</a></li>
                <li><a class="hover:text-yellow-400 hover:bg-cyan-900 px-6 py-4 rounded-lg" href="#">Section 4</a></li>
            </ul>
        </div>
        <div class="hidden xl:flex items-center space-x-5 items-center">
            <form method="POST" action="/logout"
                  class="flex flex-row items-center h-12 px-4 mr-4 rounded-lg bg-red-900 text-white hover:bg-red-800">
                            <span class="flex items-center justify-center text-lg text-white">
                                <svg fill="none"
                                     stroke-linecap="round"
                                     stroke-linejoin="round"
                                     stroke-width="2"
                                     viewBox="0 0 24 24"
                                     stroke="currentColor"
                                     class="h-6 w-6">
                                    <path d="M8 11V7a4 4 0 118 0m-4 8v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2z"></path>
                                </svg>
                            </span>
                <button type="submit" class="ml-3">Iziet</button>
            </form>
        </div>
    </nav>
</section>

<div class="w-screen flex justify-center">
    <div class="w-1/2 flex flex-col items-center bg-gray-100 p-8 rounded-md shadow-md mt-6">
        <h2 class="text-2xl mb-4 text-3xl font-semibold">Izveido savu testu</h2>
        <form id="quizForm" class="w-full">
            <label for="quiz_name"></label>
            <input id="quiz_name"
                   name="quiz_name"
                   class="mt-4 w-2/3 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg p-2.5"
                   placeholder="Ievadiet testa nosaukumu"
                   required
            >
            <div id="questionContainer" class="w-full mt-8">
                <!-- Questions and answer fields will be added here -->
            </div>
            <button type="button" id="addQuestion" class="bg-blue-500 text-white py-2 px-4 rounded-full mt-4">Pievienot
                jautājumu
            </button>
            <button type="submit" class="bg-green-500 text-white py-2 px-4 rounded-full mt-4">Izveidot testu</button>
        </form>
    </div>
</div>

<script>
    $(document).ready(function () {
        let questionCounter = 1;
        // Function to add a new question
        function addQuestion() {
            var questionHtml = `<div class="w-full mt-4">
            <label class="flex justify-center mt-4 text-lg font-semibold" for="question_${questionCounter}">Jautājums Nr. ${questionCounter}</label>
            <input type="text" id="question_${questionCounter}" name="questions[]" class="mt-4 w-2/3 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg p-2.5" placeholder="Ievadiet jautājumu" required>
            <div class="mt-2">
                <input type="text" name="answers[]" class="mt-2 bg-gray-50 border border-gray-300 text-gray-900 p-2 rounded-md" placeholder="Ievadiet atbildes variantu" required>
                <button type="button"
                        class="removeAnswer text-white py-2 px-3 ml-2">
                    <svg xmlns="http://www.w3.org/2000/svg"
                         width="20"
                         height="20"
                         fill="red"
                         class="bi bi-x"
                         viewBox="0 0 16 16">
                    <path d="M4.293 4.293a1 1 0 0 1 1.414 0L8 6.586l2.293-2.293a1 1 0 1 1 1.414 1.414L9.414 8l2.293 2.293a1 1 0 0 1-1.414 1.414L8 9.414l-2.293 2.293a1 1 0 0 1-1.414-1.414L6.586 8 4.293 5.707a1 1 0 0 1 0-1.414z"/>
                    </svg>
                </button>
            </div>
            <button type="button" class="addAnswer mt-2 bg-blue-500 text-white py-2 px-4 rounded-full mt-2">Pievienot atbildi</button>
            <button type="button" class="removeQuestion mt-2 bg-red-500 text-white py-2 px-3 rounded-full ml-2">Dzēst jautājumu</button>
        </div>`;

            $("#questionContainer").append(questionHtml);
            questionCounter++;
        }

        // Add the first question when the page loads
        addQuestion();

        // Add a new question and answer fields when "Add Question" button is clicked
        $("#addQuestion").click(function () {
            addQuestion();
        });

        // Add a new answer field when "Add Answer" button is clicked
        $("#questionContainer").on("click", ".addAnswer", function () {
            var answerInput = `<input type="text" name="answers[]" class="mt-2 bg-gray-50 border border-gray-300 text-gray-900 p-2 rounded-md" placeholder="Ievadiet atbiles variantu" required>`;
            var removeButton = `<button type="button"
                        class="removeAnswer text-white py-2 px-3 ml-2">
                    <svg xmlns="http://www.w3.org/2000/svg"
                         width="20"
                         height="20"
                         fill="red"
                         class="bi bi-x"
                         viewBox="0 0 16 16">
                    <path d="M4.293 4.293a1 1 0 0 1 1.414 0L8 6.586l2.293-2.293a1 1 0 1 1 1.414 1.414L9.414 8l2.293 2.293a1 1 0 0 1-1.414 1.414L8 9.414l-2.293 2.293a1 1 0 0 1-1.414-1.414L6.586 8 4.293 5.707a1 1 0 0 1 0-1.414z"/>
                    </svg>
                </button>`;

            $(this).prev().after(answerInput + removeButton);
        });

        // Remove an answer field when "Remove Answer" button is clicked
        $("#questionContainer").on("click", ".removeAnswer", function () {
            $(this).prev().remove(); // Remove the input field
            $(this).remove(); // Remove the "Remove Answer" button
        });

        // Remove a question when "Remove Question" button is clicked
        $("#questionContainer").on("click", ".removeQuestion", function () {
            $(this).closest("div").remove(); // Remove the entire question block
        });

        // Handle form submission using AJAX
        $("#quizForm").submit(function (event) {
            event.preventDefault();

            // Serialize form data to send via AJAX
            var formData = $(this).serializeArray();

            // AJAX POST request to send the quiz data to the server (you'll need to handle this on the server-side)
            $.ajax({
                type: "POST",
                url: "process_quiz.php", // Replace with your server-side script
                data: formData,
                success: function (response) {
                    // Handle the server response here (e.g., show a success message)
                    alert("Quiz created successfully!");
                    // Optionally, you can reset the form or redirect to another page.
                },
                error: function (error) {
                    // Handle any errors here
                    console.error(error);
                }
            });
        });
    });

</script>
</body>
</html>
